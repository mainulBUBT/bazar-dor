<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#8a3647">
    <title>Bazar Dor - Units Management</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="../../lib/bootstrap/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../../lib/bootstrap-icons/bootstrap-icons.min.css">
    <link rel="stylesheet" href="../css/admin-style.css">
    <!-- DataTables CSS -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.11.5/css/dataTables.bootstrap5.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.2.2/css/buttons.bootstrap5.min.css">
    <style>
        .units-form {
            background-color: #fff;
            border-radius: 0.5rem;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);
        }
        .export-dropdown .dropdown-menu {
            min-width: 10rem;
            padding: 0.5rem 0;
        }
        .export-dropdown .dropdown-item {
            display: flex;
            align-items: center;
            padding: 0.5rem 1rem;
        }
        .export-dropdown .dropdown-item i {
            margin-right: 0.5rem;
            font-size: 1.1rem;
        }
        .dataTables_wrapper .dataTables_length, 
        .dataTables_wrapper .dataTables_filter {
            margin-bottom: 1rem;
        }
        .dataTables_wrapper .dt-buttons {
            margin-bottom: 1rem;
        }
        .dataTables_wrapper .dataTables_info {
            padding-top: 1rem;
        }
    </style>
</head>
<body>
    <div class="admin-container">
        <!-- Sidebar -->
        <aside class="admin-sidebar">
            <div class="admin-sidebar-header">
                <h3>Bazar Dor</h3>
                <span>Admin Panel</span>
            </div>
            <div class="admin-profile">
                <div class="admin-avatar">
                    <i class="bi bi-person-circle"></i>
                </div>
                <div class="admin-info">
                    <h6>Admin User</h6>
                    <p>Administrator</p>
                </div>
            </div>
            <nav class="admin-nav">
                <div class="admin-sidebar-section">
                    <div class="admin-sidebar-section-title">Main</div>
                    <ul>
                        <li>
                            <a href="dashboard.html">
                                <i class="bi bi-speedometer2"></i>
                                <span>Dashboard</span>
                            </a>
                        </li>
                    </ul>
                </div>
                
                <div class="admin-sidebar-section">
                    <div class="admin-sidebar-section-title">Catalog</div>
                    <ul>
                        <li class="active">
                            <a href="units.html">
                                <i class="bi bi-rulers"></i>
                                <span>Units</span>
                            </a>
                        </li>
                        <li class="dropdown">
                            <a href="#">
                                <i class="bi bi-tags"></i>
                                <span>Categories</span>
                            </a>
                            <div class="dropdown-menu">
                                <a href="categories.html" class="dropdown-item">
                                    <i class="bi bi-list-ul"></i> All Categories
                                </a>
                                <a href="add-category.html" class="dropdown-item">
                                    <i class="bi bi-plus-circle"></i> Add Category
                                </a>
                            </div>
                        </li>  
                        <li class="dropdown">
                            <a href="#">
                                <i class="bi bi-box-seam"></i>
                                <span>Products</span>
                            </a>
                            <div class="dropdown-menu">
                                <a href="products.html" class="dropdown-item">
                                    <i class="bi bi-list-ul"></i> All Products
                                </a>
                                <a href="add-product.html" class="dropdown-item">
                                    <i class="bi bi-plus-circle"></i> Add Product
                                </a>
                            </div>
                        </li>
                        <li class="dropdown">
                            <a href="#">
                                <i class="bi bi-shop"></i>
                                <span>Markets</span>
                            </a>
                            <div class="dropdown-menu">
                                <a href="markets.html" class="dropdown-item">
                                    <i class="bi bi-list-ul"></i> All Markets
                                </a>
                                <a href="add-market.html" class="dropdown-item">
                                    <i class="bi bi-plus-circle"></i> Add Market
                                </a>
                            </div>
                        </li>
                    </ul>
                </div>
                
                <div class="admin-sidebar-section">
                    <div class="admin-sidebar-section-title">Users Management</div>
                    <ul>
                        <li>
                            <a href="users.html">
                                <i class="bi bi-people"></i>
                                <span>Users</span>
                            </a>
                        </li>
                        <li>
                            <a href="contributions.html">
                                <i class="bi bi-graph-up-arrow"></i>
                                <span>Contributions</span>
                            </a>
                        </li>
                        <li class="dropdown">
                            <a href="#">
                                <i class="bi bi-award"></i>
                                <span>Points Management</span>
                            </a>
                            <div class="dropdown-menu">
                                <a href="volunteer-points.html" class="dropdown-item">
                                    <i class="bi bi-plus-minus"></i> Manage Points
                                </a>
                                <a href="volunteer-transactions.html" class="dropdown-item">
                                    <i class="bi bi-list-ul"></i> Transactions
                                </a>
                            </div>
                        </li>
                        <li>
                            <a href="volunteer-redemptions.html">
                                <i class="bi bi-gift"></i>
                                <span>Redemptions</span>
                            </a>
                        </li>
                    </ul>
                </div>

                <div class="admin-sidebar-section">
                    <div class="admin-sidebar-section-title">Marketing</div>
                    <ul>
                        <li class="dropdown">
                            <a href="#">
                                <i class="bi bi-images"></i>
                                <span>Banners</span>
                            </a>
                            <div class="dropdown-menu">
                                <a href="banners.html" class="dropdown-item">
                                    <i class="bi bi-list-ul"></i> All Banners
                                </a>
                                <a href="add-banner.html" class="dropdown-item">
                                    <i class="bi bi-plus-circle"></i> Add Banner
                                </a>
                            </div>
                        </li>
                        <li class="dropdown">
                            <a href="#">
                                <i class="bi bi-star"></i>
                                <span>Featured Banners</span>
                            </a>
                            <div class="dropdown-menu">
                                <a href="featured-banners.html" class="dropdown-item">
                                    <i class="bi bi-list-ul"></i> All Featured Banners
                                </a>
                                <a href="add-featured-banner.html" class="dropdown-item">
                                    <i class="bi bi-plus-circle"></i> Add Featured Banner
                                </a>
                            </div>
                        </li>
                    </ul>
                </div>

                <div class="admin-sidebar-section">
                    <div class="admin-sidebar-section-title">Reports</div>
                    <ul>
                        <li>
                            <a href="market-reports.html">
                                <i class="bi bi-shop-window"></i>
                                <span>Market Reports</span>
                            </a>
                        </li>
                        <li>
                            <a href="product-reports.html">
                                <i class="bi bi-box2"></i>
                                <span>Product Reports</span>
                            </a>
                        </li>
                        <li>
                            <a href="price-reports.html">
                                <i class="bi bi-graph-up"></i>
                                <span>Price Analytics</span>
                            </a>
                        </li>
                        <li>
                            <a href="user-reports.html">
                                <i class="bi bi-people-fill"></i>
                                <span>User Analytics</span>
                            </a>
                        </li>
                    </ul>
                </div>
    
                <div class="admin-sidebar-section">
                    <div class="admin-sidebar-section-title">Configuration</div>
                    <ul>
                        <li>
                            <a href="zone-management.html">
                                <i class="bi bi-geo-alt"></i>
                                <span>Zone Management</span>
                            </a>
                        </li>
                        <li>
                            <a href="settings.html">
                                <i class="bi bi-gear"></i>
                                <span>Settings</span>
                            </a>
                        </li>
                        
                    </ul>
                </div>

            </nav>
            <div class="admin-sidebar-footer">
                <a href="../../index.html" class="btn btn-outline-light btn-sm">
                    <i class="bi bi-box-arrow-left"></i> Back to Site
                </a>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="admin-main">
            <!-- Top Header -->
            <header class="admin-header">
                <div class="admin-header-left">
                    <button class="toggle-sidebar-btn">
                        <i class="bi bi-list"></i>
                    </button>
                    <h4>Units Management</h4>
                </div>
                <div class="admin-header-right">
                    <div class="admin-actions">
                        <a href="#" class="admin-notification">
                            <i class="bi bi-bell"></i>
                            <span class="badge">3</span>
                        </a>
                        <div class="admin-dropdown">
                            <button class="admin-dropdown-toggle">
                                <i class="bi bi-person-circle"></i>
                                <span>Admin</span>
                                <i class="bi bi-chevron-down"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </header>

            <!-- Units Content -->
            <div class="admin-content">
                <!-- Page Header -->
                <div class="admin-content-header">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h5><i class="bi bi-rulers me-2"></i>Units Management</h5>
                        <div class="export-dropdown">
                            <button class="btn btn-outline-admin dropdown-toggle" type="button" id="exportDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                                <i class="bi bi-download me-1"></i>Export
                            </button>
                            <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="exportDropdown">
                                <li><a class="dropdown-item" href="#" id="exportPDF"><i class="bi bi-file-pdf"></i>Export to PDF</a></li>
                                <li><a class="dropdown-item" href="#" id="exportCSV"><i class="bi bi-file-spreadsheet"></i>Export to CSV</a></li>
                                <li><a class="dropdown-item" href="#" id="exportExcel"><i class="bi bi-file-excel"></i>Export to Excel</a></li>
                                <li><hr class="dropdown-divider"></li>
                                <li><a class="dropdown-item" href="#" id="printTable"><i class="bi bi-printer"></i>Print</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <!-- Units Form -->
                <div class="units-form mb-4">
                    <form id="unitForm" class="row g-3">
                        <div class="col-md-4">
                            <label for="unitName" class="form-label">Unit Name</label>
                            <input type="text" class="form-control" id="unitName" placeholder="Enter unit name">
                        </div>
                        <div class="col-md-2">
                            <label for="unitSymbol" class="form-label">Symbol</label>
                            <input type="text" class="form-control" id="unitSymbol" placeholder="e.g. kg">
                        </div>
                        <div class="col-md-3">
                            <label for="unitType" class="form-label">Type</label>
                            <select class="form-select" id="unitType">
                                <option selected value="">Select unit type</option>
                                <option value="weight">Weight</option>
                                <option value="volume">Volume</option>
                                <option value="length">Length</option>
                                <option value="count">Count</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                        <div class="col-md-3">
                            <label for="unitStatus" class="form-label">Status</label>
                            <select class="form-select" id="unitStatus">
                                <option value="active" selected>Active</option>
                                <option value="inactive">Inactive</option>
                            </select>
                        </div>
                        <div class="col-12 text-end">
                            <button type="reset" class="btn btn-outline-secondary me-2">
                                <i class="bi bi-arrow-counterclockwise me-1"></i>Reset
                            </button>
                            <button type="submit" class="btn btn-admin">
                                <i class="bi bi-plus-circle me-1"></i>Add Unit
                            </button>
                        </div>
                    </form>
                </div>
                
                <!-- Units Table -->
                <div class="admin-card">
                    <div class="admin-card-body p-0">
                        <div class="table-responsive">
                            <table class="admin-table table-hover" id="unitsTable">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Unit Name</th>
                                        <th>Symbol</th>
                                        <th>Type</th>
                                        <th>Status</th>
                                        <th>Created</th>
                                        <th class="text-end">Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>#U001</td>
                                        <td>Kilogram</td>
                                        <td>kg</td>
                                        <td>Weight</td>
                                        <td>
                                            <span class="badge bg-success">Active</span>
                                        </td>
                                        <td>2023-05-10</td>
                                        <td>
                                            <div class="action-buttons justify-content-end">
                                                <button class="btn btn-sm btn-outline-admin" title="Edit" data-bs-toggle="modal" data-bs-target="#editUnitModal">
                                                    <i class="bi bi-pencil"></i>
                                                </button>
                                                <button class="btn btn-sm btn-outline-danger" title="Delete">
                                                    <i class="bi bi-trash"></i>
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>#U002</td>
                                        <td>Liter</td>
                                        <td>L</td>
                                        <td>Volume</td>
                                        <td>
                                            <span class="badge bg-success">Active</span>
                                        </td>
                                        <td>2023-05-12</td>
                                        <td>
                                            <div class="action-buttons justify-content-end">
                                                <button class="btn btn-sm btn-outline-admin" title="Edit" data-bs-toggle="modal" data-bs-target="#editUnitModal">
                                                    <i class="bi bi-pencil"></i>
                                                </button>
                                                <button class="btn btn-sm btn-outline-danger" title="Delete">
                                                    <i class="bi bi-trash"></i>
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>#U003</td>
                                        <td>Piece</td>
                                        <td>pc</td>
                                        <td>Count</td>
                                        <td>
                                            <span class="badge bg-success">Active</span>
                                        </td>
                                        <td>2023-05-15</td>
                                        <td>
                                            <div class="action-buttons justify-content-end">
                                                <button class="btn btn-sm btn-outline-admin" title="Edit" data-bs-toggle="modal" data-bs-target="#editUnitModal">
                                                    <i class="bi bi-pencil"></i>
                                                </button>
                                                <button class="btn btn-sm btn-outline-danger" title="Delete">
                                                    <i class="bi bi-trash"></i>
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Edit Unit Modal -->
    <div class="modal fade" id="editUnitModal" tabindex="-1" aria-labelledby="editUnitModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editUnitModalLabel">Edit Unit</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="mb-3">
                            <label for="editUnitName" class="form-label">Unit Name</label>
                            <input type="text" class="form-control" id="editUnitName" value="Kilogram">
                        </div>
                        <div class="mb-3">
                            <label for="editUnitSymbol" class="form-label">Symbol</label>
                            <input type="text" class="form-control" id="editUnitSymbol" value="kg">
                        </div>
                        <div class="mb-3">
                            <label for="editUnitType" class="form-label">Type</label>
                            <select class="form-select" id="editUnitType">
                                <option>Select unit type</option>
                                <option value="weight" selected>Weight</option>
                                <option value="volume">Volume</option>
                                <option value="length">Length</option>
                                <option value="count">Count</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="editUnitStatus" class="form-label">Status</label>
                            <select class="form-select" id="editUnitStatus">
                                <option value="active" selected>Active</option>
                                <option value="inactive">Inactive</option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-admin">Save Changes</button>
                </div>
            </div>
        </div>
    </div>

    <script src="../../lib/bootstrap/bootstrap.bundle.min.js"></script>
    <script src="../js/admin.js"></script>
    <!-- DataTables JS -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.11.5/js/dataTables.bootstrap5.min.js"></script>
    <!-- DataTables Buttons -->
    <script src="https://cdn.datatables.net/buttons/2.2.2/js/dataTables.buttons.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.2.2/js/buttons.bootstrap5.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.2.2/js/buttons.html5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.2.2/js/buttons.print.min.js"></script>
    <script>
        $(document).ready(function() {
            // Initialize DataTable
            var unitsTable = $('#unitsTable').DataTable({
                responsive: true,
                language: {
                    search: "_INPUT_",
                    searchPlaceholder: "Search units...",
                    lengthMenu: "Show _MENU_ entries",
                    info: "Showing _START_ to _END_ of _TOTAL_ units",
                    infoEmpty: "Showing 0 to 0 of 0 units",
                    infoFiltered: "(filtered from _MAX_ total units)"
                },
                dom: "<'row'<'col-sm-12 col-md-6'l><'col-sm-12 col-md-6'f>>" +
                     "<'row'<'col-sm-12'tr>>" +
                     "<'row'<'col-sm-12 col-md-5'i><'col-sm-12 col-md-7'p>>",
                columnDefs: [
                    { orderable: false, targets: -1 }
                ]
            });
            
            // Handle export dropdown actions
            $('#exportPDF').on('click', function() {
                exportTable('pdf');
            });
            
            $('#exportCSV').on('click', function() {
                exportTable('csv');
            });
            
            $('#exportExcel').on('click', function() {
                exportTable('excel');
            });
            
            $('#printTable').on('click', function() {
                printTable();
            });
            
            // Export functions
            function exportTable(type) {
                var buttonType = '';
                var fileName = 'bazar_dor_units_' + getFormattedDate();
                
                switch(type) {
                    case 'pdf':
                        buttonType = 'pdfHtml5';
                        fileName += '.pdf';
                        break;
                    case 'csv':
                        buttonType = 'csvHtml5';
                        fileName += '.csv';
                        break;
                    case 'excel':
                        buttonType = 'excelHtml5';
                        fileName += '.xlsx';
                        break;
                }
                
                // Create temporary button and trigger click
                var tempButton = $('<button>').addClass('dt-button buttons-' + type);
                $.fn.dataTable.ext.buttons[buttonType].action.call(
                    unitsTable.button(tempButton).node(),
                    unitsTable.button(tempButton).action(),
                    unitsTable,
                    tempButton,
                    { 
                        title: 'Bazar Dor Units',
                        filename: fileName,
                        exportOptions: {
                            columns: ':not(:last-child)' // Exclude actions column
                        }
                    }
                );
            }
            
            function printTable() {
                // Create temporary button and trigger click
                var tempButton = $('<button>').addClass('dt-button buttons-print');
                $.fn.dataTable.ext.buttons.print.action.call(
                    unitsTable.button(tempButton).node(),
                    unitsTable.button(tempButton).action(),
                    unitsTable,
                    tempButton,
                    { 
                        title: '<h4 style="text-align:center">Bazar Dor Units</h4>',
                        exportOptions: {
                            columns: ':not(:last-child)' // Exclude actions column
                        }
                    }
                );
            }
            
            function getFormattedDate() {
                var date = new Date();
                return date.getFullYear() + '' + 
                       ('0' + (date.getMonth() + 1)).slice(-2) + '' + 
                       ('0' + date.getDate()).slice(-2);
            }
            
            // Handle unit form submission
            $('#unitForm').on('submit', function(e) {
                e.preventDefault();
                
                // Get form values
                var name = $('#unitName').val();
                var symbol = $('#unitSymbol').val();
                var type = $('#unitType').val();
                var status = $('#unitStatus').val();
                
                if (name && symbol && type) {
                    // In a real application, you would send this to the server
                    // For demo purposes, we'll just add it to the table
                    var statusBadge = status === 'active' ? 
                        '<span class="badge bg-success">Active</span>' : 
                        '<span class="badge bg-secondary">Inactive</span>';
                    
                    var today = new Date();
                    var dateFormatted = today.getFullYear() + '-' + 
                                        ('0' + (today.getMonth() + 1)).slice(-2) + '-' + 
                                        ('0' + today.getDate()).slice(-2);
                    
                    var newId = '#U00' + (unitsTable.rows().count() + 1);
                    
                    // Add new row to DataTable
                    unitsTable.row.add([
                        newId,
                        name,
                        symbol,
                        type.charAt(0).toUpperCase() + type.slice(1),
                        statusBadge,
                        dateFormatted,
                        '<div class="action-buttons justify-content-end">' +
                        '<button class="btn btn-sm btn-outline-admin" title="Edit" data-bs-toggle="modal" data-bs-target="#editUnitModal">' +
                        '<i class="bi bi-pencil"></i></button>' +
                        '<button class="btn btn-sm btn-outline-danger" title="Delete">' +
                        '<i class="bi bi-trash"></i></button>' +
                        '</div>'
                    ]).draw();
                    
                    // Reset form
                    this.reset();
                    
                    // Show success message (in a real application)
                    alert('Unit added successfully!');
                } else {
                    alert('Please fill all required fields');
                }
            });
        });
    </script>
</body>
</html>